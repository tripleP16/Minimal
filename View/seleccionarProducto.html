<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Product</title>
        <link rel="stylesheet" href="css/foundation.css">
        <link rel="stylesheet" href="css/app.css">
        <link rel="stylesheet" href="css/estilos.css">
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Sen&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Comic+Neue&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link href="css/starrr.css" rel=stylesheet/>
        <script src="js/starrr.js"></script>
        <script src="js/index.js"></script>
        <script type="text/javascript">
            window.onload = function(){
                recibirParametros();
                cargarComentarios();
            }
            var imagen;
            var id ; 
            var titulo; 
            var descripcion;
function desplegarComentarios(array){
                 
      console.log(array);
      let uno = 0; 
      let dos = 0; 
      let tres = 0; 
      let cuatro = 0; 
      let cinco = 0; 
      arr = array;
      var promedio = 0 ; 
      $('#tabla').empty();
      var tabla = [];
      for(let i = 0 ; i< array.comentario.length ; i ++){
        console.log(i);
        var puntuacio = array.comentario[i].puntuacion; 
        promedio += puntuacio;
        var tabla2="";
        let j = 0;
        switch (puntuacio){
            case 1: j=1;
                    uno ++;
                    break;
            case 2: j=2;
                    dos ++;
                    break;
            case 3: j=3;
                    tres ++; 
                    break;
            case 4: j=4;
                    cuatro ++;
                    break;
            case 5: j=5;
                    cinco ++; 
                    break;
        }

        for (let k = 0; k<j; k++){
            tabla2+=`<div class="cell large-2">
                        <img src="img/star.svg" width="15px">
                    </div>`;
        }
        tabla += `<div class="grid-x">
            <div class="cell large-4">
                <div class="descrip"><p id="preview">05/06/2020</p></div>
            </div>
            <div class="cell large-4">
               <div class="grid-x" id = "subtabla">
                   <div class="cell large-2"></div>
                   
                   ` + tabla2 +
                        
                        `
                    <div class="cell large-2"></div>
                </div>
            </div> 
            <div class="cell large-4">
                <div class="descrip comen"><p><b>${array.comentario[i].titulo}</b></p></div>
                <div class="descrip"><p id="preview">${array.comentario[i].comentario}</p></div>
            </div>
        </div>`;
       
      }
      
      $('#tabla').append(tabla);

      promedio = promedio / array.comentario.length;
      console.log(promedio);
      $('.total').text("Overrall Rating based on "+array.comentario.length+" Reviews");
      let l=0;
      if(promedio<=1){
        l =1;
      }else if (promedio > 1 && promedio <= 2){
          l=2;
      }else if (promedio > 2 && promedio <= 3){
          l= 3;
      }else if (promedio > 3 && promedio <=4){
          l = 4;
      }else{
          l = 5;
      }
      $('#cont').empty();
      let tabla3 = `<div class="cell large-2"></div>`;
      let tabla4  ="";
      $('#cont2').empty();
      for (let i = 0; i<l; i ++){
        tabla3+=`<div class="cell large-2">
                        <img src="img/star.svg" width="15px">
                    </div>`;
        tabla4 +=  `<div class="cell large-1">
                    <img src="img/star.svg" width="18px">
                </div>`;
      }
      tabla4 +=  `<div class="cell large-7">
                </div>`;
      tabla3 += `<div class="cell large-2"></div>`;

      $('#cont').append(tabla3);

      $('#cont2').append(tabla4);

      $('#prom').text(Math.round(promedio) + " Out of 5.0");

      $('.uno').text(uno + " Reviews");
      $('.dos').text(dos + " Reviews");
      $('.tres').text(tres + " Reviews");
      $('.cuatro').text(cuatro + " Reviews");
      $('.cinco').text(cinco + " Reviews");


    }
            function review(){
                window.location.href = `comentarios.html?imagen=${imagen}&id=${id}&titulo=${titulo}&descripcion=${descripcion}`;
            }
            

            function cargarComentarios(){
                var request = $.ajax({
                    url : '../Model/devolverComentarios.php', 
                    type: 'POST',
                    dataType: 'json',
                    data : {id: id}
                })

                request.done(function(data){
                    var response = JSON.parse(JSON.stringify(data)); 
                    console.log(response);
                    desplegarComentarios(response);
                    
                })
    request.fail(function( jqXHR, textStatus, errorThrown ){
        if (jqXHR.status === 0) {

            alert('Not connect: Verify Network.');
        
          } else if (jqXHR.status == 404) {
        
            alert('Requested page not found [404]');
        
          } else if (jqXHR.status == 500) {
        
            alert('Internal Server Error [500].');
        
          } else if (textStatus === 'parsererror') {
        
            alert('Requested JSON parse failed.');
        
          } else if (textStatus === 'timeout') {
        
            alert('Time out error.');
        
          } else if (textStatus === 'abort') {
        
            alert('Ajax request aborted.');
        
          } else {
        
            alert('Uncaught Error: ' + jqXHR.responseText);
        
          }
        
    });
            }
            function recibirParametros(){
                var url = new URL(window.location.href);
                imagen = url.searchParams.get("imagen");
                id = url.searchParams.get("id");
                titulo = url.searchParams.get("titulo");
                descripcion = url.searchParams.get("descripcion");
                acomodarProducto(imagen,titulo, descripcion);
            }

            function acomodarProducto(imagen,titulo, descripcion){
                $('.recuadroImag').attr('src', imagen);
                $('.orbit-image').attr('src', imagen);
                $('#tProducto').html(titulo);
                $('#dProducto').text(descripcion);
            }

    function anadirListaDeDeseos(){
                var request = $.ajax({
                    url : '../Model/anadirDeseos.php', 
                    type: 'POST',
                    dataType: 'html', 
                    data: {id:id}
                })

                request.done(function(data){
                    alert(data);
                })

    request.fail(function( jqXHR, textStatus, errorThrown ){
        if (jqXHR.status === 0) {

            alert('Not connect: Verify Network.');
        
          } else if (jqXHR.status == 404) {
        
            alert('Requested page not found [404]');
        
          } else if (jqXHR.status == 500) {
        
            alert('Internal Server Error [500].');
        
          } else if (textStatus === 'parsererror') {
        
            alert('Requested JSON parse failed.');
        
          } else if (textStatus === 'timeout') {
        
            alert('Time out error.');
        
          } else if (textStatus === 'abort') {
        
            alert('Ajax request aborted.');
        
          } else {
        
            alert('Uncaught Error: ' + jqXHR.responseText);
        
          }
        
    });
            }
            $(document).ready(function(){
                 $('#lupa').click(function(){
                    if($('#barra').is(":visible")){
                        $('#barra').hide(1000);
                    }else{
                        $('#barra').show(1000);
                    }
                    
                })
            })
            
        </script>
        
    </head>
    
    <body lang="en" >
       <div class="contenedor" id="TituloPrincipal">
            <h1 id="minimal">Minimal</h1>
       </div>
       <div class="grid-x grid-padding-x">
        <div class="menu large-4 cell align-left">
            <ul class="dropdown menu titulo " data-dropdown-menu>
                <li>
                    <a href="#" class="secondary-color">Women</a>
                    <ul class="menu">
                        <li><a id="women">All</a></li>
                        <li><a  class = "w search" value="Tops">Tops</a></li>
                        <li><a  class = "w search" value="Bottoms">Bottoms</a></li>
                        <li><a  class = "w search" value="Dresses">Dresses</a></li>
                        <li><a  class = "w search" value="Hoodies">Hoodies</a></li>
                        <li><a  class = "w search" value="Hats">Hats</a></li>
                    </ul>
                </li>
                <li><a href="#" class="show">Men</a>
                    <ul class="menu">
                        <li><a id="men">All</a></li>
                        <li><a  class="m search" value="Tops">Tops</a></li>
                        <li><a  class="m search" value="Bottoms">Bottoms</a></li>
                        <li><a  class="m search" value="Hoodies">Hoodies</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#" class="show">Collections</a>
                    <ul class="menu">
                        <li><a href="#">New Arrivals</a></li>
                        <li><a href="#">Favorites</a></li>
                        <li><a href="#">Top Rated</a></li>
                        <li><a href="#">Best Sellers</a></li>
                    </ul>
                </li>
                <li><a href="#">About</a></li>
            
            </ul>
        </div>
        
        <div class="menu titulo large-8 cell align-right">
            <ul class="dropdown menu " data-dropdown-menu>
                <li><span class="material-icons">shopping_bag</span>
                <li>
                    <a href="#" class="show">Account</a>
                    <ul class="menu">
                        <li><a href="editarUsuarioA.html"><span class="material-icons">
                            edit
                            </span>Edit my profile</a></li>
                        <li><a href="agregarProducto.html"><span class="material-icons">
                            add
                            </span> Add Product</a></li>
                        <li><a href="#"><span class="material-icons">
                            how_to_reg
                            </span> Register Admin</a></li>
                        <li><a href="../Model/cerrarSesion.php"><span class="material-icons">
                            exit_to_app
                            </span> Sign Out</a></li>
                    </ul>
                </li>
                <li>
                    <span class="material-icons large" id="lupa">search</span>
                    <div id="barra">
                        <input type="text" placeholder="Buscar" id="barrita">
                    </div>
                </li>                 
            </ul>
        </div>
    </div>
    
       
       <div class="contenedor " id="TituloSecundario">
        <br>
    </div>
    <br>
    <br>
    
    <div class="grid-x">
        <div class="cell large-1"></div>
        <div class="cell large-5">
            <div class="grid-x grid-padding-x align-center">
                <div class="cell large-4">
                    <div class="grid-x">
                        <div class="cell large-10 large-offset-2">
                            <img class="recuadroImag" src="img/0728966712_1_1_3.jpg" height="120" width="120">
                        </div>
                    </div>
                    <div class="grid-x">
                        <div class="cell large-10 large-offset-2">
                            <img class="recuadroImag" src="img/0728966712_2_1_3.jpg" height="120" width="120">
                        </div>
                    </div>
                    <div class="grid-x">
                        <div class="cell large-10 large-offset-2">
                            <img class="recuadroImag" src="img/0728966712_2_4_3.jpg" height="120" width="120">
                        </div>
                    </div> 
                </div>
                
                <div class="cell large-8">
                    <br>
                    <div class="orbit" role="region" aria-label="Product" data-orbit data-options="animInFromLeft:fade-in; animInFromRight:fade-in; animOutToLeft:fade-out; animOutToRight:fade-out;">
                        <div class="orbit-wrapper">
                            <div class="orbit-controls">
                                <button class="orbit-previous"><span class="show-for-sr">Previous Slide</span>&#9664;&#xFE0E;</button>
                                <button class="orbit-next"><span class="show-for-sr">Next Slide</span>&#9654;&#xFE0E;</button>
                            </div>
                            <ul class="orbit-container">
                                <li class="is-active orbit-slide">
                                    <figure class="orbit-figure">
                                        <img class="orbit-image" src="img/0728966712_1_1_3.jpg" height="500">
                                    </figure>
                                </li>
                                <li class="orbit-slide">
                                    <figure class="orbit-figure">
                                        <img class="orbit-image" src="img/0728966712_2_1_3.jpg">
                                    </figure>
                                </li>
                                <li class="orbit-slide">
                                    <figure class="orbit-figure">
                                        <img class="orbit-image" src="img/0728966712_2_4_3.jpg">
                                    </figure>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell large-1"></div>
        <div class="cell large-4">
            <div class="titulo"><h3 id="tProducto">Title of the Product</h3></div>
            <div class="descrip"><p id="dProducto">Simple Description</p></div>
            <div class="grid-x" id="cont2">
                
            </div>
            <hr>
            <div class="descrip"><p id="price">$Price</p></div>
            <div class="descrip"><p>Select Size:</p></div>
            <div  class="grid-x">
                <div class="cell large-1"></div>
                <div class="cell large-2">
                    <div class="descrip"><button class="hollow button" href="#">XS</button></div>
                </div>
                <div class="cell large-2">
                    <div class="descrip"><button class="hollow button" href="#">S</button></div>
                </div>
                <div class="cell large-2">
                    <div class="descrip"><button class="hollow button" href="#">M</button></div>
                </div>
                <div class="cell large-2">
                    <div class="descrip"><button class="hollow button" href="#">L</button></div>
                </div>
                <div class="cell large-2">
                    <div class="descrip"><button class="hollow button" href="#">XL</button></div>
                </div>
                <div class="cell large-1"></div>
            </div>
            <br>
            <div class="descrip"><p><a href="#">Don't know your Size?</a></p></div>
            <div class="descrip"><button id="shopButton" class="secondary button expanded" href="#">ADD TO BAG</button></div>
            <br>
            <div class="descrip"><button id="shopButton" class="hollow button expanded" onclick="anadirListaDeDeseos()"><img id="icon" src="img/heart-outline.svg" width="23px">ADD TO WISHLIST</button></div>
        
        </div>
        <div class="cell large-1"></div>
    </div>
    
    <div class="grid-x" >
        <!-- <div class="column large-1"></div> > -->
         <div class="cell large-12">
            <div><img id="separador" src="img/separador2.png"></div>
         </div>
       <!--  <div class="column large-1"></div> -->
    </div>

    <div class="contenedor">
        <h3 class="titulo">Reviews & Ratings</h3>
    </div>
    <hr>
    <br>
    
    <div class="grid-x">
        <div class="cell large-1"></div>
        <div class="cell large-4">
            <div class="grid-x">
                <div class="cell large-12">
                    <div class="descrip"><p id="preview" class="total">Overrall Rating based on N Reviews</p></div>
                </div>
            </div>
            <div class="grid-x" id="cont" >
                
            </div>
            
            <br>
            <hr>
            
            <div class="descrip"><p id="prom">0.0 out of 5.0</p></div>
            <div class="grid-x">
            <div class="cell large-8">
                <div class="grid-x">
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-7">
                        <div class="descrip"><p id="preview" class="cinco">N Reviews</p></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="grid-x">
            <div class="cell large-8">
                <div class="grid-x">
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-7">
                        <div class="descrip"><p id="preview" class="cuatro">N Reviews</p></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="grid-x">
            <div class="cell large-8">
                <div class="grid-x">
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-7">
                        <div class="descrip"><p id="preview" class="tres">N Reviews</p></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="grid-x">
            <div class="cell large-8">
                <div class="grid-x">
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-7">
                        <div class="descrip"><p id="preview" class="dos">N Reviews</p></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="grid-x">
            <div class="cell large-8">
                <div class="grid-x">
                    <div class="cell large-1">
                        <img src="img/star.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-1">
                        <img src="img/star-outline.svg" width="18px">
                    </div>
                    <div class="cell large-7">
                        <div class="descrip"><p id="preview" class="uno">N Reviews</p></div>
                    </div>
                </div>
            </div>   
        </div>
        <hr>
            <div class="titulo comen"><p><b>We want to hear from you!</b></p></div>
            <div class="descrip"><p id="preview">Tell us what you think about this item</p></div>
            <div class="descrip center"><button id="shopButton" class="hollow button" onclick="review()" >Write Review</button></div>
    </div>
    <div class="cell large-1"></div>
    <div class="cell  large-5" id="tabla">
        
    </div>
        
        <hr>
        
        
        <br>
        <div class="grid-x align-right">
                <nav aria-label="Pagination">
                    <ul class="pagination">
                        <li class="pagination-previous disabled"><span class="show-for-sr">page</span></li>
                        <li class="current descrip"><span class="show-for-sr">You're on page</span> 1</li>
                        <li class="descrip"><a href="#" aria-label="Page 2">2</a></li>
                        <li class="descrip"><a href="#" aria-label="Page 3">3</a></li>
                        <li class="ellipsis descrip" aria-hidden="true"></li>
                        <li class="pagination-next"><a href="#" aria-label="Next page"><span class="show-for-sr">page</span></a></li>
                    </ul>
                </nav>
            </div>
        
    </div>
    <div class="cell large-1"></div>
</div>
    
    
    
    
    
    
    
    
     <br>
    <div class="grid-x grid-padding-x ">
        <div class="large-12 cell" id="footer">
            <div class="grid-x grid-padding-x ">
                <div class="large-1 cell " ></div>
                <div class="large-3 cell contenedor" >
                    <br>
                    <br>
                    <br>
                    <div class="descrip large-6 cell" >© 2020 Minimal, Inc</div>
                    <div class="grid-x grid-padding-x ">
                        <div class="large-4 cell" ></div>
                        <div class="large-1 cell" >
                           <a> <i class="fa fa-facebook-f " style="font-size:28px; color: white;"></i></a>
                           <br>
                        </div>
                        <div class="large-1 cell" >
                            <a><i class="fa fa-twitter" style="font-size:24px; color: white;"></i></a>
                        </div>
                        <div class="large-1 cell" >
                            <a><i class="fa fa-instagram" style="font-size:24px; color: white;"></i></a>
                        </div>
                    </div>
                </div>
                <div class="large-3 cell contenedor" >
                    <br>
                    <p class="titulo">Shop</p>
                    <a class="foot"><p class="descrip">Women</p></a>
                    <a class="foot"><p class="descrip">Male</p></a>
                    <a class="foot"><p class="descrip">Collections</p></a>
                </div>
                <div class="large-3 cell contenedor" >
                    <br>
                    <p class="titulo">About</p>
                    <a class="foot"><p class="descrip">Policies and refunds</p></a>
                    <a class="foot"><p class="descrip">Find My Size</p></a>
                    <br> 
                    <br> 
                    
                        
                    
                </div>
                <div class="large-2 cell">
                  
                    
                    </div>
                </div>
            </div>
        </div>

 

    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/what-input.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script src="js/app.js"></script>
    </body>
</html>